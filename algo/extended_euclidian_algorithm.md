
# Обобщенный алгоритм Евклида

*w.r.t Knuth, vol 1, page 41 (rus)*

> Даны два целых положительных числа `m` и `n`. Требуется найти их наибольший делитель `d` и два целых числа `a` и `b`, таких, что `am + bn = d`

### Моя попытка

Известно, что `m = nq + r`

1. Если `r == 0`, то `d = n, a = 0, b = 1`

    `am + bn = 0*m + 1*n = n = d`
    
2. Иначе
    
    Решим аналогичную задачу для `n` и `r`. 
    
    Найдем такие `x` и `y`, что `xn + yr == d`.
    
    Вычислим `a` и `b`:
    
    ```bash
    ## On the one hand:
    am + bn == d
    a(nq + r) + bn == d
    ar + (b+aq)n == d
    
    ## On the other hand:
    xn + yr == d
    
    ## Then
    a = y
    b + aq = x
    
    ## or
    a = y
    b = x - aq
    ```    
    
<details>

<summary> Code </summary>

```python
def extended_gcd(m, n):
    q, r = divmod(m, n)
    if r == 0:
        return (0, 1, n)

    x, y, d = extended_gcd(n, r)
    return (y, x - y * q, d)
```
</details>
    
### Алгоритм из книги "Искусство программирования. Кнут. Том 1"

1. [Инициализация] Присвоить `a' <- b <- 1`, `a <- b' <- 0, c <- m, d <- n`
2. [Деление] Пусть `q` и `r` - частное и остаток от деления `c` на `d` соответственно.
3. [Остаток - нуль?] Если `r = 0`, то останавливаемся; `a`,`b`,`d` найдены
4. [Повторение цикла] Присвоить `c <- d`, `d <- r`, `t <- a', a' <- a, a <- t - qa`, `t <- b', b' <- b, b <- t - qb` и вернуться к шагу 2.

##### Как это работает

Важно заметить, что на каждом шаге выполняются следующие равенства: 

```
a'm + b'n = c
am + bn = d
```

Это означает, что если на текущей итерации`r == 0`, то `a`,`b`,`d`  имеют искомые значения.

Используя их можно вывести формулы из 4 шага алгоритма:

*(Далее маленькие буквы (`a,a',b,b'`) означают предыдущую итерацию, а заглавные (`A,A',B,B'`) - следующую)*

```
a'm + b'n = c
am + bn = d
c = qd + r 

C = d
D = r

--- Вычисляем A' и B'

Из [A'm + B'n = C] и [C = d] следует:

[A'm + B'n = am + bn]

[A' = a]  ([a' <- a] из шага 4)
[B' = b]  ([b' <- b] из шага 4)

--- Вычисляем A и B

Из [Am + Bn = D] и [D = r] следует:

[Am + Bn = c - qd = a'm + b'n - q (am + bn)]
или
[Am + Bn = (a' - qa)m + (b' - qb)n]

[A = a' - qa]  ([t <- a', a <- t - qa] из шага 4 шага)
[B = b' - qb]  ([t <- b', b <- t - qb] из шага 4 шага)
```
